---
title: 闇の01BFSに対する防衛術
# description: 

date: 2024-01-18
draft: true
# lastmod: yyyy-mm-dd
# hidedate: true

# ogimage: https://hoge/fuga/piyo.img

tags:
  - 競技プログラミング
  - アルゴリズム
  - 典型テク
archives:
  - 2024
  - 2024-01
# sample
# - yyyy
# - yyyy-mm

math: true
# toc: false
# build: {list: never}
---

## はじめに
本稿では辺の重みに条件の付いた単一始点最短経路問題を$O(|V| + |E|)$で解くアルゴリズムを解説します。
このアルゴリズムは競技プログラミングにおいて「01BFS」と呼ばれることが多いです。

## 設定
辺に重みのついた有向グラフであって、次の条件を満たすものを考える。

- 辺の重みは$0$か、自然数$k$のどちらか2種類のみである。

## アルゴリズムの説明
仮定より、どのような頂点を選んでも、始点からの最短距離は$xk ~ (x \in \mathbb{Z}\_{\geq 0})$にしかなりません。
これを利用して、次のようにして最短経路を決めていくことが出来ます。

**注意**: 説明のために次の用語を用います。(オレオレ用語です)
- 周囲を見ていない頂点 : その頂点を起点として、隣接頂点の最短経路長更新を試みたことがないもの

<div style="background : white; padding : 1em; border : solid black 1px;">
01BFS(最もナイーブなもの)

1. 最短経路長が確定していて、かつ周囲を見ていない頂点の集合を$V_{未}$とする。最初、始点の最短距離を$0$にして、$V\_{未}に加える。$

2. $v \in V_{未}$の周囲を見て、辺の重みが$0$であり、かつ最短経路長が未確定であれば、その頂点の最短経路長を$v \in V_{未}$と同じに確定させ、$V_{未}$に加える。これを$V_{未}$のサイズが変化しなくなるまで続ける。

3. $v \in V_{未}$の周囲を見て、辺の重みが$k$であり、かつ最短経路長が未確定であれば、その頂点の最短経路長を$k$だけ大きいものに確定させ、$V^{\prime}\_{未}$に追加する。

4. $V^{\prime}\_{未} = \emptyset$であれば終了。そうでなければ$V_{未} \leftarrow V^{\prime}\_{未}$(代入)とし、2に戻る。

</div>
